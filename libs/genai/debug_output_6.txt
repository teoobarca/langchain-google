/Users/hamper/Documents/Programming/nexana/langchain-google/.venv/lib/python3.14/site-packages/langsmith/schemas.py:22: UserWarning: Core Pydantic V1 functionality isn't compatible with Python 3.14 or greater.
  from pydantic.v1 import (
============================= test session starts ==============================
platform darwin -- Python 3.14.0, pytest-9.0.1, pluggy-1.6.0
rootdir: /Users/hamper/Documents/Programming/nexana/langchain-google/libs/genai
configfile: pyproject.toml
plugins: anyio-4.11.0, langsmith-0.4.46
collected 1 item

tests/unit_tests/test_chat_models.py F

=================================== FAILURES ===================================
________________ test_modalities_override_in_generation_config _________________

    def test_modalities_override_in_generation_config() -> None:
        """Test response modalities in invoke `generation_config` override model-defined."""
        from langchain_google_genai import Modality
    
        # Mock response with both image and text content
        mock_response = Mock()
        mock_response.candidates = [
            Candidate(
                content=Content(
                    parts=[
                        Part(
                            inline_data=genai_types.Blob(
                                mime_type="image/jpeg",
                                data=base64.b64decode(
                                    "/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAABAAEDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAv/xAAUEAEAAAAAAAAAAAAAAAAAAAAA/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAX/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwCdABmX/9k="
                                ),
                            )
                        ),
                        Part(text="Meow! Here's a cat image for you."),
                    ]
                ),
                finish_reason=genai_types.FinishReason.STOP,
            )
        ]
        # Create proper usage metadata using dict approach
        # from google.ai.generativelanguage_v1beta.types import UsageMetadata
    
>       mock_response.usage_metadata = genai_types.GenerateContentResponseUsageMetadata.model_validate(
            {
                "prompt_token_count": 10,
                "response_token_count": 5,
                "total_token_count": 15,
            }
        )
E       pydantic_core._pydantic_core.ValidationError: 1 validation error for GenerateContentResponseUsageMetadata
E       response_token_count
E         Extra inputs are not permitted [type=extra_forbidden, input_value=5, input_type=int]
E           For further information visit https://errors.pydantic.dev/2.12/v/extra_forbidden

tests/unit_tests/test_chat_models.py:2003: ValidationError
=============================== warnings summary ===============================
../../.venv/lib/python3.14/site-packages/_pytest/config/__init__.py:1397
  /Users/hamper/Documents/Programming/nexana/langchain-google/.venv/lib/python3.14/site-packages/_pytest/config/__init__.py:1397: PytestConfigWarning: Unknown config option: asyncio_mode
  
    self._warn_or_fail_if_strict(f"Unknown config option: {key}\n")

../../.venv/lib/python3.14/site-packages/google/genai/types.py:43
  /Users/hamper/Documents/Programming/nexana/langchain-google/.venv/lib/python3.14/site-packages/google/genai/types.py:43: DeprecationWarning: '_UnionGenericAlias' is deprecated and slated for removal in Python 3.17
    VersionedUnionType = Union[builtin_types.UnionType, _UnionGenericAlias]

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/unit_tests/test_chat_models.py::test_modalities_override_in_generation_config
======================== 1 failed, 2 warnings in 0.51s =========================
