/Users/hamper/Documents/Programming/nexana/langchain-google/.venv/lib/python3.14/site-packages/langsmith/schemas.py:22: UserWarning: Core Pydantic V1 functionality isn't compatible with Python 3.14 or greater.
  from pydantic.v1 import (
============================= test session starts ==============================
platform darwin -- Python 3.14.0, pytest-9.0.1, pluggy-1.6.0
rootdir: /Users/hamper/Documents/Programming/nexana/langchain-google/libs/genai
configfile: pyproject.toml
plugins: anyio-4.11.0, langsmith-0.4.46
collected 1 item

tests/unit_tests/test_chat_models.py DEBUG: genai_types has Blob: True
DEBUG: genai_types has Content: True
F

=================================== FAILURES ===================================
_____________________ test_signature_round_trip_conversion _____________________

    def test_signature_round_trip_conversion() -> None:
        """Test complete round-trip signature handling in conversation context."""
    
        # Debug print
        print(f"DEBUG: genai_types has Blob: {'Blob' in dir(genai_types)}")
        print(f"DEBUG: genai_types has Content: {'Content' in dir(genai_types)}")
    
        # Create a mock response with thought signature
        binary_sig = b"test_sig_data"
        mock_response = GenerateContentResponse(
            candidates=[
                Candidate(
                    content=Content(
                        parts=[
                            Part(
                                text="I need to think...",
                                thought=True,
                                thought_signature=binary_sig,
                            ),
                            Part(text="Final answer", thought_signature=binary_sig),
                        ]
                    )
                )
            ]
        )
    
        with patch("langchain_google_genai.chat_models._chat_with_retry") as mock_chat:
            mock_chat.return_value = mock_response
    
            llm = ChatGoogleGenerativeAI(
                model=MODEL_NAME,
                google_api_key=SecretStr(FAKE_API_KEY),
                output_version="v1",
                include_thoughts=True,
            )
    
            # First call - get response with signatures
>           result = llm.invoke("Test message")
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^

tests/unit_tests/test_chat_models.py:2488: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
langchain_google_genai/chat_models.py:1961: in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../.venv/lib/python3.14/site-packages/langchain_core/language_models/chat_models.py:398: in invoke
    self.generate_prompt(
../../.venv/lib/python3.14/site-packages/langchain_core/language_models/chat_models.py:1117: in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../.venv/lib/python3.14/site-packages/langchain_core/language_models/chat_models.py:927: in generate
    self._generate_with_cache(
../../.venv/lib/python3.14/site-packages/langchain_core/language_models/chat_models.py:1221: in _generate_with_cache
    result = self._generate(
langchain_google_genai/chat_models.py:2077: in _generate
    request = self._prepare_request(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = ChatGoogleGenerativeAI(output_version='v1', model='models/gemini-2.5-flash', google_api_key=SecretStr('**********'), include_thoughts=True, client=<google.genai.client.Client object at 0x119a36ba0>, default_metadata=(), model_kwargs={})
messages = [HumanMessage(content='Test message', additional_kwargs={}, response_metadata={})]
stop = None, tools = None, functions = None, safety_settings = None
tool_config = None, tool_choice = None, generation_config = None
cached_content = None

    def _prepare_request(
        self,
        messages: list[BaseMessage],
        *,
        stop: list[str] | None = None,
        tools: Sequence[_ToolDict | GoogleTool] | None = None,
        functions: Sequence[_FunctionDeclarationType] | None = None,
        safety_settings: SafetySettingDict | None = None,
        tool_config: dict | _ToolConfigDict | None = None,
        tool_choice: _ToolChoiceType | bool | None = None,
        generation_config: dict[str, Any] | None = None,
        cached_content: str | None = None,
        **kwargs: Any,
    ) -> dict[str, Any]:
        if tool_choice and tool_config:
            msg = (
                "Must specify at most one of tool_choice and tool_config, received "
                f"both:\n\n{tool_choice=}\n\n{tool_config=}"
            )
            raise ValueError(msg)
    
        formatted_tools = None
>       code_execution_tool = GoogleTool(code_execution=genai_types.CodeExecution())
                                                        ^^^^^^^^^^^^^^^^^^^^^^^^^
E       AttributeError: module 'google.genai.types' has no attribute 'CodeExecution'

langchain_google_genai/chat_models.py:2315: AttributeError
=============================== warnings summary ===============================
../../.venv/lib/python3.14/site-packages/_pytest/config/__init__.py:1397
  /Users/hamper/Documents/Programming/nexana/langchain-google/.venv/lib/python3.14/site-packages/_pytest/config/__init__.py:1397: PytestConfigWarning: Unknown config option: asyncio_mode
  
    self._warn_or_fail_if_strict(f"Unknown config option: {key}\n")

../../.venv/lib/python3.14/site-packages/google/genai/types.py:43
  /Users/hamper/Documents/Programming/nexana/langchain-google/.venv/lib/python3.14/site-packages/google/genai/types.py:43: DeprecationWarning: '_UnionGenericAlias' is deprecated and slated for removal in Python 3.17
    VersionedUnionType = Union[builtin_types.UnionType, _UnionGenericAlias]

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/unit_tests/test_chat_models.py::test_signature_round_trip_conversion
======================== 1 failed, 2 warnings in 0.70s =========================
